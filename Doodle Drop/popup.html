<!doctype html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Doodle Drop</title>
    <link rel="stylesheet" href="popup.css" />
  </head>
  <body>
    <div class="app">
      <!-- Header -->
      <header class="header">
        <div class="brand">
          <div class="logo">
            <svg width="22" height="22" viewBox="0 0 22 22" fill="none">
              <circle cx="11" cy="11" r="10" fill="url(#logo-grad)" />
              <path d="M8 14c0 0 1.5-6 3-6s3 6 3 6" stroke="#fff" stroke-width="2" stroke-linecap="round" fill="none" />
              <defs>
                <linearGradient id="logo-grad" x1="0" y1="0" x2="22" y2="22">
                  <stop offset="0%" stop-color="#ff6b4a" />
                  <stop offset="100%" stop-color="#ff8f6a" />
                </linearGradient>
              </defs>
            </svg>
          </div>
          <h1>Doodle Drop</h1>
        </div>
        <button id="settingsToggle" class="icon-btn" title="Settings">
          <svg width="18" height="18" viewBox="0 0 18 18" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round">
            <circle cx="9" cy="9" r="3" />
            <path d="M9 1v2M9 15v2M1 9h2M15 9h2M3.3 3.3l1.4 1.4M13.3 13.3l1.4 1.4M3.3 14.7l1.4-1.4M13.3 4.7l1.4-1.4" />
          </svg>
        </button>
      </header>

      <!-- Settings Panel (collapsible) -->
      <div id="settingsPanel" class="settings-panel">
        <div class="settings-inner">
          <label class="field">
            <span>Your name</span>
            <input id="yourName" type="text" placeholder="Enter your name" maxlength="24" />
          </label>
          <label class="field">
            <span>Backend URL</span>
            <input id="backendUrl" type="text" placeholder="https://mighty-eyes-bake.loca.lt" />
          </label>
          <div class="field">
            <span>My invite code</span>
            <div class="input-group">
              <input id="myCode" type="text" readonly />
              <button id="copyMyCodeBtn" class="btn-sm">Copy</button>
            </div>
          </div>
          <button id="syncInboxBtn" class="btn btn-outline full-width">
            <svg width="14" height="14" viewBox="0 0 14 14" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round">
              <path d="M1 7a6 6 0 0 1 11.2-3M13 7a6 6 0 0 1-11.2 3" />
              <path d="M13 1v3h-3M1 13v-3h3" />
            </svg>
            Sync Inbox
          </button>
        </div>
      </div>

      <!-- Tab Navigation -->
      <nav class="tab-bar">
        <button class="tab active" data-tab="draw">
          <svg width="15" height="15" viewBox="0 0 16 16" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
            <path d="M11.5 1.5l3 3-9 9H2.5v-3l9-9z" />
          </svg>
          Draw
        </button>
        <button class="tab" data-tab="share">
          <svg width="15" height="15" viewBox="0 0 16 16" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
            <path d="M1 1l13 7-13 7V9l9-1-9-1z" />
          </svg>
          Share
        </button>
        <button class="tab" data-tab="friends">
          <svg width="15" height="15" viewBox="0 0 16 16" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round">
            <circle cx="6" cy="5" r="2.5" />
            <path d="M1 14c0-3 2.5-5 5-5s5 2 5 5" />
            <circle cx="12.5" cy="5.5" r="1.5" />
            <path d="M15 14c0-2-1.5-3.5-3-3.5" />
          </svg>
          Friends
          <span id="requestBadge" class="badge" style="display:none;">0</span>
        </button>
        <button class="tab" data-tab="gallery">
          <svg width="15" height="15" viewBox="0 0 16 16" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
            <rect x="1" y="1" width="5.5" height="5.5" rx="1.2" />
            <rect x="9.5" y="1" width="5.5" height="5.5" rx="1.2" />
            <rect x="1" y="9.5" width="5.5" height="5.5" rx="1.2" />
            <rect x="9.5" y="9.5" width="5.5" height="5.5" rx="1.2" />
          </svg>
          Gallery
        </button>
      </nav>

      <!-- DRAW TAB -->
      <section id="tab-draw" class="tab-content active">
        <div class="canvas-area">
          <canvas id="doodleCanvas" width="320" height="200"></canvas>
          <div class="canvas-toolbar">
            <div class="color-picker-wrap">
              <input id="colorPicker" type="color" value="#1f160c" />
            </div>
            <div class="size-control">
              <div class="size-preview" id="sizePreview"></div>
              <input id="sizePicker" type="range" min="2" max="18" value="6" />
            </div>
            <div class="tool-divider"></div>
            <button id="eraserBtn" class="tool-btn" title="Eraser">
              <svg width="15" height="15" viewBox="0 0 16 16" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round">
                <path d="M3 13h10" />
                <path d="M4.5 10.5L10 5l3 3-4.5 4.5H6z" />
              </svg>
            </button>
            <button id="clearBtn" class="tool-btn" title="Clear canvas">
              <svg width="15" height="15" viewBox="0 0 16 16" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round">
                <path d="M2 4h12M5 4V3a1 1 0 0 1 1-1h4a1 1 0 0 1 1 1v1M6 7v5M10 7v5" />
                <path d="M3 4l1 9a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1l1-9" />
              </svg>
            </button>
          </div>
        </div>
        <div class="draw-actions">
          <button id="saveBtn" class="btn btn-primary">
            <svg width="14" height="14" viewBox="0 0 14 14" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round">
              <path d="M7 1v9M3 6l4 4 4-4" />
              <path d="M1 10v2a1 1 0 0 0 1 1h10a1 1 0 0 0 1-1v-2" />
            </svg>
            Save Doodle
          </button>
          <button id="sendBtn" class="btn btn-outline">
            <svg width="14" height="14" viewBox="0 0 14 14" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round">
              <path d="M1 7h12M9 3l4 4-4 4" />
            </svg>
            Quick Send
          </button>
        </div>
      </section>

      <!-- SHARE TAB -->
      <section id="tab-share" class="tab-content">
        <div class="share-card">
          <label class="field">
            <span>Send to</span>
            <select id="friendSelect"></select>
          </label>
          <div class="mode-toggle">
            <button id="sendInExtension" class="toggle-btn active">
              <svg width="14" height="14" viewBox="0 0 14 14" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round">
                <path d="M8 1H3a1 1 0 0 0-1 1v10a1 1 0 0 0 1 1h8a1 1 0 0 0 1-1V5L8 1z" />
                <path d="M8 1v4h4" />
              </svg>
              Link
            </button>
            <button id="sendSms" class="toggle-btn">
              <svg width="14" height="14" viewBox="0 0 14 14" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round">
                <rect x="1" y="2" width="12" height="9" rx="1.5" />
                <path d="M1 4l6 4 6-4" />
              </svg>
              SMS
            </button>
          </div>
          <div class="preview-card">
            <div class="preview-label">Message preview</div>
            <div id="messagePreview" class="preview-text"></div>
          </div>
          <div class="share-actions">
            <button id="copyCodeBtn" class="btn btn-outline">
              <svg width="14" height="14" viewBox="0 0 14 14" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round">
                <rect x="4" y="4" width="8" height="8" rx="1" />
                <path d="M10 4V2a1 1 0 0 0-1-1H3a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h2" />
              </svg>
              Copy Link
            </button>
            <button id="sendNowBtn" class="btn btn-primary">
              <svg width="14" height="14" viewBox="0 0 14 14" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round">
                <path d="M1 1l12 6-12 6V8l8-1-8-1z" />
              </svg>
              Send Now
            </button>
          </div>
        </div>
      </section>

      <!-- FRIENDS TAB -->
      <section id="tab-friends" class="tab-content">
        <!-- Incoming Friend Requests -->
        <div id="requestsSection" class="requests-section" style="display:none;">
          <div class="requests-header">
            <svg width="16" height="16" viewBox="0 0 16 16" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round">
              <circle cx="8" cy="8" r="7" />
              <path d="M8 5v3l2 2" />
            </svg>
            <span>Friend Requests</span>
          </div>
          <div id="requestsList" class="requests-list"></div>
        </div>

        <form id="friendForm" class="friend-form">
          <div class="form-row">
            <label class="field">
              <span>Name</span>
              <input id="friendName" type="text" placeholder="Friend's name" required />
            </label>
            <label class="field">
              <span>Invite code</span>
              <input id="friendCode" type="text" placeholder="ABC12345" required />
            </label>
          </div>
          <label class="field">
            <span>Phone (optional)</span>
            <input id="friendPhone" type="tel" placeholder="+1 234 567 8901" />
          </label>
          <button type="submit" class="btn btn-primary full-width">
            <svg width="14" height="14" viewBox="0 0 14 14" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round">
              <path d="M7 2v10M2 7h10" />
            </svg>
            Add Friend
          </button>
        </form>
        <ul id="friendsList" class="friends-list"></ul>
      </section>

      <!-- GALLERY TAB -->
      <section id="tab-gallery" class="tab-content">
        <div class="gallery-tabs">
          <button class="gallery-tab active" data-gallery="saved">Saved</button>
          <button class="gallery-tab" data-gallery="inbox">Inbox</button>
        </div>
        <div id="gallery-saved" class="gallery-content active">
          <div id="gallery" class="gallery-grid"></div>
        </div>
        <div id="gallery-inbox" class="gallery-content">
          <div id="inbox" class="gallery-grid"></div>
        </div>
      </section>
    </div>

    <!-- Toast -->
    <div id="toast" class="toast"></div>

    <script src="popup.js"></script>
  </body>
</html>
